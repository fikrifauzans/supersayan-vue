"use strict";(globalThis["webpackChunksupersayan"]=globalThis["webpackChunksupersayan"]||[]).push([[14],{7014:(e,l,a)=>{a.r(l),a.d(l,{default:()=>v});a(6890);var t=a(9835),o=a(6970);const d={class:"col-12 row"},i={class:"col-12 row justify-between"},n=(0,t._)("div",{class:"q-mb-sm"},"Tambahkan produk kedalam keranjang anda",-1),u={class:"text-bold col-12 q-mb-sm q-px-sm"},s={class:"col-12 row"},m=(0,t._)("div",{class:"text-bold col-12 q-mb-md"},"Total Products",-1);function c(e,l,a,c,r,p){const h=(0,t.up)("s-loading"),b=(0,t.up)("t-input"),V=(0,t.up)("t-datetime"),_=(0,t.up)("s-form"),y=(0,t.up)("t-select-api"),g=(0,t.up)("q-btn"),k=(0,t.up)("t-currency"),q=(0,t.up)("q-separator"),v=(0,t.up)("q-card"),U=(0,t.up)("s-drawer");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(h,{load:r.loading},null,8,["load"]),(0,t.Wm)(U,{onRefresh:e.refresh,useModal:r.useModal,form:"",onSubmit:p.submit,onBack:p.back,Meta:r.Meta},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(_,{class:"q-px-md q-pt-lg",title:"Form Transaksi / Sales"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{col:"6",label:"code",modelValue:r.model.code,"onUpdate:modelValue":l[0]||(l[0]=e=>r.model.code=e),topLabel:"code",readonly:""},null,8,["modelValue"]),(0,t.Wm)(V,{modelValue:r.model.date,"onUpdate:modelValue":l[1]||(l[1]=e=>r.model.date=e),col:"6",dateTime:"",label:"date",topLabel:"date",readonly:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{class:"q-px-md q-pt-lg",title:"Form Customer"},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.Wm)(y,{col:"4",label:"Customer",modelValue:r.model.customer_id,"onUpdate:modelValue":l[2]||(l[2]=e=>r.model.customer_id=e),api:"customers",optionValue:"id",optionLabel:"name"},null,8,["modelValue"])])])),_:1}),(0,t.Wm)(_,{class:"q-px-md q-pt-lg",title:"Form Produk"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{bordered:"",flat:"",class:"col-12 row q-pt-lg q-px-lg q-mb-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",i,[n,(0,t._)("div",null,[(0,t.Wm)(g,{label:"Tambah Produk",size:"sm",color:"primary",class:"q-mb-md",onClick:l[3]||(l[3]=e=>r.model.transaction_details.unshift({product_id:null}))})])]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.model.transaction_details,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{key:e,class:"col-12 row q-mb-md"},[(0,t._)("div",u,"Item "+(0,o.zw)(l+1),1),(0,t.Wm)(y,{col:"3",label:"Products",modelValue:e.product_id,"onUpdate:modelValue":l=>e.product_id=l,api:"products",optionLabel:"name",optionValue:"id",onUpdateEvent:l=>e.price=l.price,select:["id,name,price"]},null,8,["modelValue","onUpdate:modelValue","onUpdateEvent"]),(0,t.Wm)(k,{col:"3",label:"price",currency:"",modelValue:e.price,"onUpdate:modelValue":l=>e.price=l,topLabel:"price",readonly:""},null,8,["modelValue","onUpdate:modelValue"]),null!=e.price&&void 0!=e.price&&0!=e.price?((0,t.wg)(),(0,t.j4)(k,{key:0,col:"3",label:"qty",currency:"",modelValue:e.qty,"onUpdate:modelValue":l=>e.qty=l,topLabel:"qty",onUpdateEvent:()=>p.calculateProduct(e)},null,8,["modelValue","onUpdate:modelValue","onUpdateEvent"])):(0,t.kq)("",!0),null!=e.price&&void 0!=e.price&&0!=e.price?((0,t.wg)(),(0,t.j4)(k,{key:1,col:"3",label:"discount in percent",currency:"",modelValue:e.discount_in_percent,"onUpdate:modelValue":l=>e.discount_in_percent=l,topLabel:"discount in percent",onUpdateEvent:()=>p.calculateProduct(e),max:"100"},null,8,["modelValue","onUpdate:modelValue","onUpdateEvent"])):(0,t.kq)("",!0),null!=e.price&&void 0!=e.price&&0!=e.price?((0,t.wg)(),(0,t.j4)(k,{key:2,col:"3",label:"discount in rupiah",currency:"",modelValue:e.discount_in_rupiah,"onUpdate:modelValue":l=>e.discount_in_rupiah=l,topLabel:"discount in rupiah",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0),null!=e.price&&void 0!=e.price&&0!=e.price?((0,t.wg)(),(0,t.j4)(k,{key:3,col:"3",label:"amount",currency:"",modelValue:e.amount,"onUpdate:modelValue":l=>e.amount=l,topLabel:"amount",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0),null!=e.price&&void 0!=e.price&&0!=e.price?((0,t.wg)(),(0,t.j4)(k,{key:4,col:"3",label:"total",currency:"",modelValue:e.total,"onUpdate:modelValue":l=>e.total=l,topLabel:"total",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0),(0,t._)("div",null,[(0,t.Wm)(g,{icon:"delete",color:"negative",round:"",rouned:"",size:"sm",onClick:e=>r.model.transaction_details.splice(l,1)},null,8,["onClick"])]),(0,t.Wm)(q,{class:"col-12",style:{height:"1px"}})])))),128)),(0,t._)("div",s,[m,(0,t.Wm)(k,{col:"3",label:"subtotal",currency:"",modelValue:r.model.subtotal,"onUpdate:modelValue":l[4]||(l[4]=e=>r.model.subtotal=e),topLabel:"subtotal",readonly:""},null,8,["modelValue"]),(0,t.Wm)(k,{col:"3",label:"discount",currency:"",modelValue:r.model.discount,"onUpdate:modelValue":l[5]||(l[5]=e=>r.model.discount=e),topLabel:"discount",onUpdateEvent:l[6]||(l[6]=e=>p.calculateProduct())},null,8,["modelValue"]),(0,t.Wm)(k,{col:"3",label:"ongkir",currency:"",modelValue:r.model.ongkir,"onUpdate:modelValue":l[7]||(l[7]=e=>r.model.ongkir=e),topLabel:"ongkir",onUpdateEvent:l[8]||(l[8]=e=>p.calculateProduct())},null,8,["modelValue"]),(0,t.Wm)(k,{col:"3",label:"total",currency:"",modelValue:r.model.total,"onUpdate:modelValue":l[9]||(l[9]=e=>r.model.total=e),topLabel:"total",readonly:""},null,8,["modelValue"])])])),_:1})])),_:1})])])),_:1},8,["onRefresh","useModal","onSubmit","onBack","Meta"])])}a(9665);var r=a(4218),p=a(4170);const h={name:r.Z.name+"Form",props:["modal","id","submitOnModal"],created(){this.$Handle.loadingStart(),this.model=this.$Handle.resetObjectValue(this.Meta.model),this.$route.params.id&&(this.param=this.$route.params.id?this.$route.params.id:null),this.id&&(this.param=this.id?this.id:null),this.modal&&!0===this.modal.add&&(this.useModal=!0),this.modal&&!0===this.modal.edit&&(this.useModal=!0),null!==this.param&&this.findId(this.param),this.model.code=`TRX-${this.$Help.randomString(10)}`,setInterval((()=>{this.model.date=this.$Help.generateDate()}),1e3),this.$Handle.loadingStop()},data(){return{Meta:r.Z,useModal:!1,model:r.Z.model,loading:!1,edit:!1,param:null,date:p.ZP,product:null}},watch:{submitOnModal:function(e){e.isTrusted&&this.submit()}},methods:{findId(e){let l=r.Z.module+"/"+e;this.$api.get(l,((e,l,a,t)=>{200==l&&(this.model=e,this.$Handle.loadingStop())}))},async submit(){this.$Handle.loadingStart(),null!==this.param?await this.editData(this.param):await this.postData(this.model)},editData(e){let l=this.Meta.module+"/"+e;this.$api.put(l,this.model,((e,l,a,t)=>{200==l&&(this.$Handle.successMessage(a),this.$Handle.loadingStop(),this.back())}))},postData(e){let l=this.Meta.module;this.$api.post(l,e,((e,l,a,t)=>{200==l&&(this.$Handle.successMessage(a),this.$Handle.loadingStop(),this.back())}))},back(){if(1!=this.useModal)return this.$router.push({name:r.Z.module,query:{...this.$route.query}});this.$emit("closeModal")},calculateProduct(e){if(void 0!=e){e.price,e.qty,e.discount_in_percent,e.discount_in_rupiah,e.amount,e.total;e.discount_in_rupiah=e.discount_in_percent/100*e.price,e.amount=e.price-e.discount_in_rupiah,e.total=e.qty*e.amount}try{this.model.subtotal=this.model.transaction_details.map((e=>e.total)).reduce(((e,l)=>e+l)),this.model.total=this.model.subtotal-this.model.discount+this.model.ongkir}catch(l){return!1}}}};var b=a(1639),V=a(4458),_=a(8879),y=a(926),g=a(9984),k=a.n(g);const q=(0,b.Z)(h,[["render",c]]),v=q;k()(h,"components",{QCard:V.Z,QBtn:_.Z,QSeparator:y.Z})}}]);